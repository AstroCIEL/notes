# 2.25shuttle记录与反思

## 主体

![part](image.png)

- 代工厂会开发和迭代自己的工艺库文件，有各种不同选项的组合。这些工艺库文件可以由代理申请得到，来给到客户（也就是我们）。我们利用这些工艺库文件来将行为级模型映射到物理实现，或者自己通过工艺库中提供的器件搭成一个更大的模块的物理实现，也是gds版图文件，这个过程就是广义上我们说的后端。

- 我们这个版图还需要满足代工厂规定的设计规则（Design rule），例如同一层的金属间距的要求或者时密度的要求等等，如果违反了这些要求，芯片就有可能造出来是无法工作的。所以我们的版图必须经过DRC（design rule check），尽量修复版图中所有的违例。但是有时候我们不得不违反其中的某些设计规则，那么这一些违例也并不一定都非常严重，有些违例可能是有正当的理由的，或者说对于生产影响较小，因此我们在上交版图的同时，需要交一份DRC报告，说明违例的条目以及原因，给到代工厂，然后代工厂来研判这些违例是否可以waive（赦免）。正常情况下，在shuttle日期前，我们可能会多轮进行以下步骤：向代工厂提供版图和drc报告、得到工厂反馈后修复无法赦免的违例，然后再给出新的gds，直到最后一版gds没有任何违例或者所有违例都可以被赦免。

- 此外，代工厂可能还会提供一些ip供我们在设计中使用，比方说PLL。但是这个PLL的版图信息（partial gds）可能是无法完整给到我们的，所以从某种角度看我们拿到的是一个黑盒，我们可以使用它，但是内部的结构不是完全清楚的。那这样的话假如我们的设计中使用了这类ip的话，我们最终的版图里面就有一个黑盒了，信息肯定是有缺失的。这样的话就需要将我们的版图交到代工厂，代工厂把这个黑盒里面的完整结构填进我们的版图里，这个过程就是merge。代工厂merge ip是需要2-3天时间的，因此如果确定需要这个流程，那么就更需要预留出充足的时间。

- 此外，还需要向工厂提供版图信息的一些summary，比方说用到了哪些层、是否有用到特殊的器件啊、版图中有效的窗口尺寸和位置啊等等，这些信息也都是需要和我们的版图对应上的。

## 时间线

![time](image-1.png)

由于初次流片，经验不足，很多地方都有踩坑，相比于期望的交付时间2.25延迟了8天。

## 反思

- 尽早、尽可能全面地验证rtl
  - 使用[spyglass](/frontend/spyglass.md)对rtl进行全面的检查，在设计早期发现潜在的问题。
- [工艺文件](/basic/smic28HKD.md)一定要要全。选定金属层选项后，需要有配套的、**最新**的
  - `PDK`
  - `std cell`
  - `io cell`
  - `sram compiler`
  - `techfile`, `layermap`, `design rule`，且里面的层信息都需要对应上
  - `DRC`
  - `QRC`(Cadence Innovus when PR)
  - `StarRC`(Synopsys PrimeTime when sign-off)
  - `Dummy`
  - `redhawk`
- 仔细研读并在遇到各种问题的时候去查看`Design Rule`文档、std cell和io cell的datasheet以及waive list
  - 各种金属层的说明以及DRC都在文档里面有详细说明
  - waive list可能在errortype文件
- 工艺迁移的时候，一定要检查所有label以及text，不能遗留旧工艺的信息
  - 例如T家会在其器件的某些层的金属上打上高度为零也就是不可见的label来保留其版权信息
  - 检查VSIA层信息
- 合理规划电源域，并做好隔离，防止不同的电源之间串扰以及注意IR drop
- 注意io cell还有pad的尺寸，尽量让信号io和电源io统一尺寸，并需要与封装厂确认是否支持封装
- 一定要为自己留足时间上的裕度。如果一个东西三天后要交，那么必须让上游提前两天交过来，否则到了ddl就会很被动
- 找外包并不是让外包帮忙handle所有，外包的作用是帮忙干一些你知道怎么做但没时间和人力做的事情，依然要保持“自己handle整个流程”的态度，才能把控好每个细节不出岔子
